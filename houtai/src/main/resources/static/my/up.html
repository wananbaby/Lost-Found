<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
	</head>
	<body>
		
		<nobr>
			<button onclick="location.href='my.html'">返回</button>
			<h1 id="h1id" style="text-align: center">文件上传</h1>
		</nobr>
		
		<div>
			<img id="preview" >
		</div>
		<form action="/Update/fileUpdate" id="form" method="post" enctype="multipart/form-data" onsubmit="return check()">
			<input type="file" id="file" name="file" accept="image/*"/>
			<h2 style="display: inline">物品名称：</h2><input type="text" id="name" style="display: inline">&emsp;
			<h2 style="display: inline">上传人：</h2><input type="text" id="h2id" style="display: inline">&emsp;
			<h2 style="display: inline">备注：</h2><input type="text" id="beizhu" style="display: inline">&emsp;
			<input type="submit"/>
		</form>
		<div id="myDiv"></div>
		
		
		<script>
			// function uf() {
			//
			// 	this.location = "up_success.html"
			// }




			var fileDom = document.getElementById("file");
            var previewDom = document.getElementById("preview");
            fileDom.addEventListener("change", e=>{
                var file = fileDom.files[0];
                // check if input contains a valid image file
                if (!file || file.type.indexOf("image/") < 0) {
                    fileDom.value = "";
                    previewDom.src = "";
					alert("不是图片")
                    return;
                }

                // use FileReader to load image and show preview of the image
                var fileReader = new FileReader();
                fileReader.onload = e=>{
                    previewDom.src = e.target.result;
                };
                fileReader.readAsDataURL(file);
            });

            var formDom = document.getElementById("form");
            function check() {
                var file = fileDom.files[0];
                // check if input contains a valid image file
                if (!file || file.type.indexOf("image/") < 0) {
                    return false;
                }
                window.location='up_success.html';
                return true;
            }
		</script>
		<script type="text/javascript">
			window.onload = function () {
				const username = sessionStorage.getItem("username");
				// alert(username);
				document.getElementById("h2id").innerText = username;
			}
		</script>
		<script type="text/javascript" src="information.js"></script>
		
	</body>
</html>
