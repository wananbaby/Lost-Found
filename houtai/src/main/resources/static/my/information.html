<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
		<link rel="stylesheet" type="text/css" href="../css/weui.min.css">
		<link rel="stylesheet" type="text/css" href="../css/jquery-weui.min.css">
	</head>
	<body>
		<div class="button_sp_area"style="margin-left: 1%">
			<br>
			<a href="my.html" class="weui-btn weui-btn_mini weui-btn_primary" style="background-color: #0bb20c">返回</a>
		</div>
		<h1 style="text-align: center;">我的信息</h1>
		<div class="weui-cells weui-cells_form">
			
			<div class="weui-cells">
			  <div class="weui-cell"><div class="weui-cell__hd"><label class="weui-label">昵称</label></div>
			    <div class="weui-cell__bd">
			      <input class="weui-input" type="text" placeholder="请输入昵称" id="nicheng">
			    </div>
			  </div>
			</div>
			
		  <div class="weui-cell">
		    <div class="weui-cell__hd"><label class="weui-label">qq</label></div>
		    <div class="weui-cell__bd">
		      <input class="weui-input" type="number" pattern="[0-9]*" placeholder="请输入qq号" id="qqhao">
		    </div>
		  </div>
		  <div class="weui-cell weui-cell_vcode">
		    <div class="weui-cell__hd">
		      <label class="weui-label">手机号</label>
		    </div>
		    <div class="weui-cell__bd">
		      <input class="weui-input" type="tel" placeholder="请输入手机号" id="phone">
		    </div>
		    <!-- <div class="weui-cell__ft">
		      <button class="weui-vcode-btn">获取验证码</button>
		    </div> -->
		  </div>
		  <div class="weui-cell">
		    <div class="weui-cell__hd"><label class="weui-label">丢失日期</label></div>
		    <div class="weui-cell__bd">
		      <input class="weui-input" type="date" id="frtime">
		    </div>
			<div class="weui-cell__bd">
			  <input class="weui-input" type="date" id="totime">
			</div>
		  </div>
		  
		  <!-- <div class="weui-cell">
		    <div class="weui-cell__hd"><label for="" class="weui-label">时间</label></div>
		    <div class="weui-cell__bd">
		      <input class="weui-input" type="datetime-local" value="" placeholder="">
		    </div>
		  </div> -->
		  <!-- <div class="weui-cell weui-cell_vcode">
		    <div class="weui-cell__hd"><label class="weui-label">验证码</label></div>
		    <div class="weui-cell__bd">
		      <input class="weui-input" type="number" placeholder="请输入验证码">
		    </div>
		    <div class="weui-cell__ft">
		      <img class="weui-vcode-img" src="./images/vcode.jpg">
		    </div>
		  </div> -->
		</div>
		<!--以上为必填信息-->
		
		<div class="weui-cells__tips">👆最好都填</div>
		
		<!-- <div class="weui-cells__title">表单报错</div>
		<div class="weui-cells weui-cells_form">
		  <div class="weui-cell weui-cell_warn">
		    <div class="weui-cell__hd"><label for="" class="weui-label">卡号</label></div>
		    <div class="weui-cell__bd">
		      <input class="weui-input" type="number" pattern="[0-9]*" value="weui input error" placeholder="请输入卡号">
		    </div>
		    <div class="weui-cell__ft">
		      <i class="weui-icon-warn"></i>
		    </div>
		  </div>
		</div> -->
		
		
		<!-- <div class="weui-cells__title">开关</div>
		<div class="weui-cells weui-cells_form">
		  <div class="weui-cell weui-cell_switch">
		    <div class="weui-cell__bd">标题文字</div>
		    <div class="weui-cell__ft">
		      <input class="weui-switch" type="checkbox">
		    </div>
		  </div>
		  <div class="weui-cell weui-cell_switch">
		    <div class="weui-cell__bd">兼容IE Edge的版本</div>
		    <div class="weui-cell__ft">
		      <label for="switchCP" class="weui-switch-cp">
		        <input id="switchCP" class="weui-switch-cp__input" type="checkbox" checked="checked">
		        <div class="weui-switch-cp__box"></div>
		      </label>
		    </div>
		  </div>
		</div> -->
		<div class="weui-cells__title">备注👇</div>
		<div class="weui-cells weui-cells_form">
		  <div class="weui-cell">
		    <div class="weui-cell__bd">
		      <textarea class="weui-textarea" placeholder="请输入文本" rows="3" id="beizhu"></textarea>
		      <div class="weui-textarea-counter"><span>0</span>/200</div>
		    </div>
		  </div>
		</div>
		 <div class="weui-btn-area">
		      <a class="weui-btn weui-btn_primary" id="confirm" style="background-color: #04BE02" onclick="demo()">确定</a>
		</div>
<!--		<input type="button" id="confirm" value="按钮" onclick="demo()"/>-->


		<script type="text/javascript" src="../js/jquery-3.3.1.js"></script>
	<script type="text/javascript">


		// 昵称
		// $("#nicheng").val();
		// qq号
		// $("#qqhao").val();
		// phone
		// $("#phone").val();
		// 丢失日期
		// $("#frtime").val();
		// $("#totime").val();
		// 备注
		// $("#beizhu").val();

		function demo() {

			// alert($("#nicheng").val())
			// alert(nicheng)

			var inform = {
				nicheng:$("#nicheng").val()|| null,
					qqhao:$("#qqhao").val() || null,
					phone:$("#phone").val() || null,
					frtime:$("#frtime").val() || null,
					totime:$("#totime").val() || null,
					beizhu:$("#beizhu").val() || null
			};

			$.ajax({
				
				url: "/wexin/UpdateUserInformation",
				data: JSON.stringify(inform),
				type: "post",
				dataType: "json",
				contentType: "application/json; charset=UTF-8",
				async:false,
				success:function (data) {
					const size = d.size;
					// alert(size)// 2
					const ImgMap = d.imgMap;
					var map1 = _objToStrMap(ImgMap)
					// console.log(map1)
					// var miaoshu1 = map1.get("0")
					// console.log(miaoshu1)
					// console.log(miaoshu1.miaoshu)
					// let k = (0).toString()
					// console.log(k)
					// alert(k)
					// var miao = map1.get(k)
					// console.log(miao)
					// var w = JSON.stringify(miao)
					// var m = JSON.parse(w)
					// console.log(m)

					let h1ID = "miaoshu_1";
					let imgID = "img_1";
					let h1TEXT = "hhh";

					let classID = "img_bu";
					let widthID = "60%";
					let HeightID = "80";
					let srcID = "../img/no.jpg";
					for (let i = 0;i<size;i++){
						let imgReadDTO = {
							miaoshu: null,
							src: null,
							remark: null,
							UserId:null
							// id:null
						};
						let k = (i).toString()
						let j = map1.get(k);
						if(j){
							if (j.miaoshu){
								imgReadDTO.miaoshu = j.miaoshu;
								imgReadDTO.src = j.src;
								imgReadDTO.remark = j.remark;
								imgReadDTO.UserId = j.UserId;
								// imgReadDTO.id = j.id
								map.put(i,imgReadDTO)
							}
						}
						// console.log(i)
						let h1ID = "miaoshu_" + i.toString();
						let imgID = "img_" + i.toString();
						let h2ID = "beizhu_" + i.toString();

						let imginformation = map.get(i);
						let h1TEXT = imginformation.miaoshu;
						let srcID = imginformation.src;
						let remarkID = imginformation.remark;
						let userID = imginformation.UserId;
						let lihiimg = "<li class='licl'><h1 id="+h1ID+">"+h1TEXT+"</h1>"
								+"<img src="+srcID+" width="+widthID+" id="+imgID+" class="+
								classID+"><h3 style=\"display:inline-block\" id="+h2ID+">"+remarkID+"</h3>"+"</li>";
						$("#ulid").append(lihiimg);
					}
				},
				error:function (e) {
					alert("更新失败");
					console.log(JSON.stringify(e));
				}
			}) ;

		}
	</script>
	</body>
</html>
